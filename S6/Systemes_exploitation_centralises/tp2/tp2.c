#include <stdio.h> /* entrées sorties */
#include <unistd.h> /* primitives de base : fork, ...*/
#include <stdlib.h> /* exit */
#include <sys/wait.h> /* wait */

static int compteur = 0; 

void handler(int num_sign) {
  printf("pid : %d, Numéro du signal : %d \n", getpid(), num_sign);
}

void hdl_alarme(int num_sign) {
  printf("%d actif \n", getpid());
  compteur++;
  alarm(5);
}

int main(int argc, char *argv[]) {
  pid_t pidFils;
  int codeTerm;
  pidFils = fork();
  if (pidFils == 0) {
    execl("/bin/sleep", "/bin/sleep", "3", NULL);
  } 
  wait(&codeTerm);
  if (WIFEXITED(codeTerm)) {
    printf("\nsignal terminaison fils : %d\n", WEXITSTATUS(codeTerm));
  }
  signal(SIGINT, handler);
  signal(SIGALRM, hdl_alarme);
  alarm(5);
  do {
    pause();
  } while(compteur <5);
  return EXIT_SUCCESS;
}
